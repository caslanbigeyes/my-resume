æœºå™¨å­¦ä¹ 02

day02-

ä¸Šè¯¾æ—¥æœŸ
@June 14, 2025
ä¸»è®²è€å¸ˆ
ææ™“å
å¤ä¹ 
@June 15, 2025
æœ¬è¯¾ç¨‹å…³é”®è¯ NumPyï½œå‘é‡åŒ–æ“ä½œï½œå¹¿æ’­æœºåˆ¶ï½œç‰¹å¾å·¥ç¨‹ï½œK è¿‘é‚»ç®—æ³•ï½œæ ‡å‡†åŒ–
è¯¾æ—¶
6

ğŸ”¢ ç¬¬ä¸€éƒ¨åˆ†ï¼šNumPy åŸºæœ¬æ“ä½œ

æ•°ç»„åˆ›å»º
1.2 å…ƒç´ çº§è¿ç®—ï¼ˆElement-wise Operationsï¼‰
1.3 å¹¿æ’­æœºåˆ¶ï¼ˆBroadcastingï¼‰
1.4 æ•°å­¦å‡½æ•°
ğŸ“ ç¬¬äºŒéƒ¨åˆ†ï¼šNumPy å‘é‡åŒ–æ“ä½œ
2.1 å‘é‡ç©ºé—´åŸºç¡€
2.2 å‘é‡æ¨¡é•¿è®¡ç®—
2.3 å‘é‡å†…ç§¯ä¸ä½™å¼¦ç›¸ä¼¼åº¦
2.4 æ¬§å‡ é‡Œå¾—è·ç¦»
2.5 çŸ©é˜µè¿ç®—
ğŸ”§ ç¬¬ä¸‰éƒ¨åˆ†ï¼šç‰¹å¾å·¥ç¨‹
3.1 æ•°æ®é›†ä»‹ç»
3.2 ç‰¹å¾æ ‡å‡†åŒ–
3.3 å…¶ä»–è§„èŒƒåŒ–æ–¹æ³•
ğŸ¯ ç¬¬å››éƒ¨åˆ†ï¼šK è¿‘é‚»åˆ†ç±»ç®—æ³•
4.1 ç®—æ³•åŸç†
4.2 å®Œæ•´æœºå™¨å­¦ä¹ æµç¨‹
4.3 å…³é”®æ³¨æ„äº‹é¡¹
ğŸ“ˆ ç¬¬äº”éƒ¨åˆ†ï¼šK è¿‘é‚»å›å½’ç®—æ³•
5.1 æ•°æ®é›†ä»‹ç»
5.2 å›å½’ç®—æ³•æµç¨‹
5.3 å›å½’è¯„ä¼°æŒ‡æ ‡
ğŸ”‘ æ ¸å¿ƒè¦ç‚¹æ€»ç»“
NumPy æ ¸å¿ƒæ¦‚å¿µ
ç‰¹å¾å·¥ç¨‹è¦ç‚¹
KNN ç®—æ³•æ ¸å¿ƒ
æœºå™¨å­¦ä¹ æ ‡å‡†æµç¨‹
ğŸš€ å®è·µå»ºè®®
1.1

ğŸ”¢ ç¬¬ä¸€éƒ¨åˆ†ï¼šNumPy åŸºæœ¬æ“ä½œ
1.1

æ•°ç»„åˆ›å»º

æ ¸å¿ƒæ¦‚å¿µï¼šNumPy æ˜¯ Python ç§‘å­¦è®¡ç®—çš„åŸºç¡€åº“ï¼Œæä¾›é«˜æ•ˆçš„å¤šç»´æ•°ç»„å¯¹è±¡å’Œæ•°å­¦å‡½æ•°ã€‚
import numpy as np

ä»åˆ—è¡¨åˆ›å»ºæ•°ç»„

#
scores = [random.randint(0, 100) for _ in range(300)]
arr = np.array(scores)

åˆ›å»ºç‰¹æ®Šæ•°ç»„

#
zeros_array = np.zeros(shape=(2, 3, 4, 5)) #

å…¨é›¶æ•°ç»„
ones_array = np.ones(shape=(2,))
# å…¨ä¸€æ•°ç»„
range_array = np.arange(10)
# 0-9çš„æ•°ç»„
linspace_array = np.linspace(-10, 10, 100) # ç­‰å·®æ•°åˆ—
é‡è¦å±æ€§ï¼š
æœºå™¨å­¦ä¹ 02

day02-

1

æ•°ç»„å½¢çŠ¶
: å…ƒç´ æ€»æ•°
: æ•°æ®ç±»å‹

arr.shape :
arr.size

arr.dtype

1.2

å…ƒç´ çº§è¿ç®—ï¼ˆElement-wise Operationsï¼‰

å…³é”®ç‰¹æ€§ï¼šNumPy æ”¯æŒå‘é‡åŒ–æ“ä½œï¼Œè‡ªåŠ¨åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šã€‚
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])
#

åŸºæœ¬è¿ç®—

result_add = a + b # [5, 7, 9]
result_mul = a * b # [4, 10, 18]
result_pow = a ** b # [1, 32, 729]

ä¸æ ‡é‡è¿ç®—

#
scalar_add = a + 1

# [2, 3, 4]

ä¸ Python åˆ—è¡¨å¯¹æ¯”ï¼š
åˆ—è¡¨ï¼š
NumPyï¼š

[1,2,3] + [4,5,6] = [1,2,3,4,5,6]

(

è¿æ¥)

array([1,2,3]) + array([4,5,6]) = array([5,7,9])

1.3

å¹¿æ’­æœºåˆ¶ï¼ˆBroadcastingï¼‰

(

å…ƒç´ çº§ç›¸åŠ )

å®šä¹‰ï¼šåœ¨ä¸å¼•èµ·æ­§ä¹‰çš„å‰æä¸‹ï¼ŒNumPy è‡ªåŠ¨è°ƒæ•´æ•°ç»„å½¢çŠ¶ä»¥è¿›è¡Œè¿ç®—ã€‚
arr1 = np.array([1, 2, 3, 4, 5]) # shape: (5,)
arr2 = np.array([3])
# shape: (1,)
result = arr1 + arr2
#
: [4, 5, 6, 7, 8]

å¹¿æ’­æˆåŠŸ

äºŒç»´å¹¿æ’­ç¤ºä¾‹

#
arr2d = np.array([[1], [2]])
result2d = arr1 + arr2d

# shape: (2, 1)
#
shape: (2, 5)

ç»“æœ

å¹¿æ’­è§„åˆ™ï¼š
1. ä»æœ€åä¸€ä¸ªç»´åº¦å¼€å§‹æ¯”è¾ƒ
2. ç»´åº¦å¤§å°ç›¸ç­‰æˆ–å…¶ä¸­ä¸€ä¸ªä¸º 1 æ—¶å¯ä»¥å¹¿æ’­
3. ç¼ºå¤±ç»´åº¦è§†ä¸º 1
1.4

æ•°å­¦å‡½æ•°

arr = np.array([1, 2, 3, 4, 5])

ä¸‰è§’å‡½æ•°

#
sin_values = np.sin(arr)
cos_values = np.cos(arr)

æŒ‡æ•°å’Œå¯¹æ•°

#
exp_values = np.exp(arr)
log_values = np.log(arr)
log2_values = np.log2(arr)
log10_values = np.log10(arr)

ğŸ“ ç¬¬äºŒéƒ¨åˆ†ï¼šNumPy å‘é‡åŒ–æ“ä½œ
æœºå™¨å­¦ä¹ 02

day02-

2

2.1

å‘é‡ç©ºé—´åŸºç¡€

æ ¸å¿ƒæ¦‚å¿µï¼šä»å‘é‡ç©ºé—´è§’åº¦ç†è§£æ•°æ®ï¼Œæ¶‰åŠæ¨¡é•¿ã€å¤¹è§’å’Œå†…ç§¯ã€‚
2.2

å‘é‡æ¨¡é•¿è®¡ç®—

æ•°å­¦å…¬å¼ï¼šå¯¹äºå‘é‡

v = [v1 , v2 , ..., vn ]
â€‹

â€‹

â€‹

ï¼Œæ¨¡é•¿ä¸ºï¼š
ï»¿

âˆ£vâˆ£ =

v

2
1

â€‹

+ v

2
2

â€‹

+ ... + v

2
n

â€‹

â€‹

v1 = np.array([1, 2, 3, 4, 5])

æ–¹æ³• ï¼šæ‰‹åŠ¨è®¡ç®—

#
1
norm_manual = (v1 ** 2).sum() ** 0.5
#

æ–¹æ³•2ï¼šä½¿ç”¨ NumPy å‡½æ•°

norm_numpy = np.linalg.norm(v1)

2.3

å‘é‡å†…ç§¯ä¸ä½™å¼¦ç›¸ä¼¼åº¦

å†…ç§¯å…¬å¼ï¼š
ä½™å¼¦ç›¸ä¼¼åº¦å…¬å¼ï¼š

v1 â‹… v2 = âˆ‘
â€‹

â€‹

n
i=1

â€‹

v1i Ã— v2i
â€‹

ï»¿
â€‹

v1 â‹… v2
â€‹

cos(Î¸) =

â€‹

â€‹

âˆ£v1 âˆ£ Ã— âˆ£v2 âˆ£
â€‹

â€‹

v1 = np.array([1, 2, 3, 4, 5])
v2 = np.array([6, 3, 1, 3, 6])

å†…ç§¯è®¡ç®—

#
dot_product_manual = (v1 * v2).sum()
dot_product_operator = v1 @ v2
#

ä½™å¼¦ç›¸ä¼¼åº¦

cosine_similarity = v1 @ v2 / (np.linalg.norm(v1) * np.linalg.norm(v2))

2.4

æ¬§å‡ é‡Œå¾—è·ç¦»

å…¬å¼ï¼š

d(v1 , v2 ) =
â€‹

â€‹

âˆ‘

n
i=1

(v1i âˆ’ v2i )
â€‹

â€‹

â€‹

2

ï»¿
â€‹

æ¬§å‡ é‡Œå¾—è·ç¦»
euclidean_distance = ((v1 - v2) ** 2).sum() ** 0.5
# æˆ–ä½¿ç”¨ NumPy
#

euclidean_distance = np.linalg.norm(v1 - v2)

2.5

çŸ©é˜µè¿ç®—

m1 = np.arange(12).reshape(3, 4) # 3Ã—4
m2 = np.arange(12).reshape(4, 3) # 4Ã—3

çŸ©é˜µ
çŸ©é˜µ

çŸ©é˜µä¹˜æ³•ï¼ˆæ³¨æ„ç»´åº¦åŒ¹é…ï¼‰
result = m1 @ m2 # ç»“æœä¸º 3Ã—3 çŸ©é˜µ
#

ğŸ”§ ç¬¬ä¸‰éƒ¨åˆ†ï¼šç‰¹å¾å·¥ç¨‹
3.1

æœºå™¨å­¦ä¹ 02

day02-

æ•°æ®é›†ä»‹ç»

3

ä½¿ç”¨ ä¹³è…ºç™Œå¨æ–¯åº·è¾›æ•°æ®é›†ï¼š
æ ·æœ¬æ•°é‡ï¼š569 ä¸ª
ç‰¹å¾æ•°é‡ï¼š30 ä¸ªæ•°å€¼ç‰¹å¾
ç›®æ ‡å˜é‡ï¼šäºŒåˆ†ç±»ï¼ˆæ¶æ€§/è‰¯æ€§ï¼‰
from sklearn.datasets import load_breast_cancer
X, y = load_breast_cancer(return_X_y=True)
print(f"
print(f"

3.2

ç‰¹å¾çŸ©é˜µå½¢çŠ¶: {X.shape}") # (569, 30)
ç›®æ ‡å‘é‡å½¢çŠ¶: {y.shape}") # (569,)

ç‰¹å¾æ ‡å‡†åŒ–

é—®é¢˜ï¼šä¸åŒç‰¹å¾çš„é‡çº²å’Œæ•°å€¼èŒƒå›´å·®å¼‚å·¨å¤§ï¼Œä¼šå½±å“ç®—æ³•æ€§èƒ½ã€‚
è§£å†³æ–¹æ¡ˆï¼šZ-score æ ‡å‡†åŒ–
æ•°å­¦å…¬å¼ï¼š
x

æ ‡å‡†åŒ–

x âˆ’ Î¼
â€‹

=

â€‹

Ïƒ

å…¶ä¸­ï¼š
ï»¿æ˜¯ç‰¹å¾å‡å€¼
ï»¿æ˜¯ç‰¹å¾æ ‡å‡†å·®
Î¼
Ïƒ

è®¡ç®—ç»Ÿè®¡é‡

#
mu = X.mean(axis=0)

å„ç‰¹å¾å‡å€¼
sigma = X.std(axis=0) # å„ç‰¹å¾æ ‡å‡†å·®
# æ ‡å‡†åŒ–
#

X_standardized = (X - mu) / sigma

æ ‡å‡†åŒ–æ•ˆæœï¼š
å‡å€¼å˜ä¸º 0
æ ‡å‡†å·®å˜ä¸º 1
æ¶ˆé™¤é‡çº²å½±å“
3.3

å…¶ä»–è§„èŒƒåŒ–æ–¹æ³•

Min-Max

è§„èŒƒåŒ–ï¼š

x

è§„èŒƒåŒ–

â€‹

=

x âˆ’ xmin

â€‹

xmax âˆ’ xmin
â€‹

è§„èŒƒåŒ–åˆ°

â€‹

â€‹

åŒºé—´

# Min-Max
[0,1]
X_minmax = (X - X.min(axis=0)) / (X.max(axis=0) - X.min(axis=0))

ğŸ¯ ç¬¬å››éƒ¨åˆ†ï¼šK è¿‘é‚»åˆ†ç±»ç®—æ³•
4.1

ç®—æ³•åŸç†

æ ¸å¿ƒæ€æƒ³ï¼šæ ¹æ®æ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„ K ä¸ªæœ€è¿‘é‚»å±…çš„æ ‡ç­¾æ¥é¢„æµ‹å…¶ç±»åˆ«ã€‚
å†³ç­–è§„åˆ™ï¼šå¯¹äºåˆ†ç±»é—®é¢˜ï¼Œé‡‡ç”¨å¤šæ•°æŠ•ç¥¨åŸåˆ™ã€‚
KNN

4.2

æœºå™¨å­¦ä¹ 02

day02-

å®Œæ•´æœºå™¨å­¦ä¹ æµç¨‹

4

from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier

åŠ è½½æ•°æ®

# 1.
X, y = load_breast_cancer(return_X_y=True)

æ•°æ®åˆ‡åˆ†

# 2.
X_train, X_test, y_train, y_test = train_test_split(
X, y, test_size=0.2, shuffle=True, random_state=0
)
# 3.

ç‰¹å¾æ ‡å‡†åŒ–ï¼ˆé‡è¦ï¼ï¼‰

mu = X_train.mean(axis=0)
sigma = X_train.std(axis=0)
X_train_scaled = (X_train - mu) / sigma
X_test_scaled = (X_test - mu) / sigma

æ¨¡å‹è®­ç»ƒ

# 4.
knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train_scaled, y_train)
# 5.

é¢„æµ‹å’Œè¯„ä¼°

y_pred = knn.predict(X_test_scaled)
accuracy = (y_pred == y_test).mean()
print(f"
: {accuracy:.4f}")

å‡†ç¡®ç‡

4.3

å…³é”®æ³¨æ„äº‹é¡¹

ä¸ºä»€ä¹ˆéœ€è¦æ ‡å‡†åŒ–ï¼Ÿ
KNN åŸºäºè·ç¦»è®¡ç®—
ä¸åŒç‰¹å¾çš„æ•°å€¼èŒƒå›´å·®å¼‚ä¼šå¯¼è‡´æŸäº›ç‰¹å¾ä¸»å¯¼è·ç¦»è®¡ç®—
æ ‡å‡†åŒ–ç¡®ä¿æ‰€æœ‰ç‰¹å¾ç­‰æƒé‡å‚ä¸è®¡ç®—
æ•°æ®æ³„éœ²é˜²èŒƒï¼š
âœ… æ­£ç¡®åšæ³•ï¼šç”¨è®­ç»ƒé›†ç»Ÿè®¡é‡æ ‡å‡†åŒ–æµ‹è¯•é›†
âŒ é”™è¯¯åšæ³•ï¼šç”¨å…¨ä½“æ•°æ®ç»Ÿè®¡é‡æ ‡å‡†åŒ–

ğŸ“ˆ ç¬¬äº”éƒ¨åˆ†ï¼šK è¿‘é‚»å›å½’ç®—æ³•
5.1

æ•°æ®é›†ä»‹ç»

ä½¿ç”¨ æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†ï¼š
æ ·æœ¬æ•°é‡ï¼š506 ä¸ª
ç‰¹å¾æ•°é‡ï¼š13 ä¸ªæˆ¿å±‹ç›¸å…³ç‰¹å¾
ç›®æ ‡å˜é‡ï¼šæˆ¿ä»·ï¼ˆè¿ç»­å€¼ï¼‰
import pandas as pd
#

åŠ è½½æ•°æ®

data = pd.read_csv("boston_house_prices.csv", skiprows=1)
X = data.loc[:, :"LSTAT"].to_numpy() #
y = data.loc[:, "MEDV"].to_numpy() #

ç‰¹å¾
ç›®æ ‡å˜é‡ï¼ˆæˆ¿ä»·ï¼‰

æœºå™¨å­¦ä¹ 02

day02-

5

5.2

å›å½’ç®—æ³•æµç¨‹

from sklearn.neighbors import KNeighborsRegressor

æ•°æ®åˆ‡åˆ†å’Œæ ‡å‡†åŒ–ï¼ˆä¸åˆ†ç±»ç›¸åŒï¼‰

#

X_train, X_test, y_train, y_test = train_test_split(
X, y, test_size=0.2, random_state=0
)
mu = X_train.mean(axis=0)
sigma = X_train.std(axis=0)
X_train_scaled = (X_train - mu) / sigma
X_test_scaled = (X_test - mu) / sigma

å›å½’æ¨¡å‹

#

knn_reg = KNeighborsRegressor(n_neighbors=5)
knn_reg.fit(X_train_scaled, y_train)
y_pred = knn_reg.predict(X_test_scaled)

5.3

å›å½’è¯„ä¼°æŒ‡æ ‡

å¹³å‡ç»å¯¹è¯¯å·® (MAE)ï¼š
n

1
MAE =

â€‹

n

âˆ‘ âˆ£yi âˆ’ y
^i âˆ£
â€‹

â€‹

â€‹

â€‹

i=1

å‡æ–¹è¯¯å·® (MSE)ï¼š
n

1
MSE =

â€‹

n

âˆ‘(yi âˆ’ y
^i )
â€‹

â€‹

â€‹

2

â€‹

i=1

è¯„ä¼°æŒ‡æ ‡è®¡ç®—

#
mae = abs(y_pred - y_test).mean()
mse = ((y_pred - y_test) ** 2).mean()
rmse = mse ** 0.5

å¹³å‡ç»å¯¹è¯¯å·®: {mae:.4f}")
å‡æ–¹è¯¯å·®: {mse:.4f}")
print(f"å‡æ–¹æ ¹è¯¯å·®: {rmse:.4f}")
print(f"
print(f"

ğŸ”‘ æ ¸å¿ƒè¦ç‚¹æ€»ç»“
NumPy

æ ¸å¿ƒæ¦‚å¿µ

å‘é‡åŒ–æ“ä½œï¼šæé«˜è®¡ç®—æ•ˆç‡çš„å…³é”®
å¹¿æ’­æœºåˆ¶ï¼šå®ç°ä¸åŒå½¢çŠ¶æ•°ç»„çš„è¿ç®—
çº¿æ€§ä»£æ•°å‡½æ•°ï¼šæ¨¡é•¿ã€å†…ç§¯ã€è·ç¦»è®¡ç®—

ç‰¹å¾å·¥ç¨‹è¦ç‚¹

æ ‡å‡†åŒ–å¿…è¦æ€§ï¼šæ¶ˆé™¤ç‰¹å¾é—´çš„é‡çº²å·®å¼‚
æ•°æ®æ³„éœ²é˜²èŒƒï¼šå§‹ç»ˆç”¨è®­ç»ƒé›†ç»Ÿè®¡é‡å¤„ç†æµ‹è¯•é›†
Z-score vs Min-Maxï¼šæ ¹æ®æ•°æ®åˆ†å¸ƒé€‰æ‹©åˆé€‚æ–¹æ³•

KNN

ç®—æ³•æ ¸å¿ƒ

è·ç¦»åº¦é‡ï¼šæ¬§å‡ é‡Œå¾—è·ç¦»æœ€å¸¸ç”¨

æœºå™¨å­¦ä¹ 02

day02-

6

å€¼é€‰æ‹©ï¼šå½±å“æ¨¡å‹å¤æ‚åº¦å’Œæ€§èƒ½
åˆ†ç±» vs å›å½’ï¼šæŠ•ç¥¨æœºåˆ¶ vs å¹³å‡å€¼æœºåˆ¶
K

æœºå™¨å­¦ä¹ æ ‡å‡†æµç¨‹
1.

æ•°æ®åŠ è½½ â†’ 2. æ•°æ®åˆ‡åˆ† â†’ 3. ç‰¹å¾é¢„å¤„ç† â†’ 4. æ¨¡å‹è®­ç»ƒ â†’ 5. é¢„æµ‹è¯„ä¼°

ğŸš€ å®è·µå»ºè®®

ä»£ç å®è·µï¼šæ¯ä¸ªæ¦‚å¿µéƒ½è¦äº²è‡ªç¼–å†™ä»£ç éªŒè¯
2. å‚æ•°è°ƒä¼˜ï¼šå°è¯•ä¸åŒçš„ K å€¼ï¼Œè§‚å¯Ÿæ€§èƒ½å˜åŒ–
3. æ•°æ®å¯è§†åŒ–ï¼šç”¨å›¾è¡¨ç†è§£æ•°æ®åˆ†å¸ƒå’Œç®—æ³•æ•ˆæœ
4. æ‰©å±•å­¦ä¹ ï¼šäº†è§£å…¶ä»–è·ç¦»åº¦é‡æ–¹æ³•å’Œé¢„å¤„ç†æŠ€æœ¯
1.

æœºå™¨å­¦ä¹ 02

day02-

7

