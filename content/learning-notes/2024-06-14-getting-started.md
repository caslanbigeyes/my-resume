---
title: "æœºå™¨å­¦ä¹ 02 - AIE54 Day02å­¦ä¹ ç¬”è®°"
date: "2024-06-14"
summary: "æœºå™¨å­¦ä¹ ç¬¬äºŒå¤©å­¦ä¹ å†…å®¹ï¼ŒåŒ…æ‹¬NumPyåŸºæœ¬æ“ä½œã€å‘é‡åŒ–æ“ä½œã€ç‰¹å¾å·¥ç¨‹å’ŒKè¿‘é‚»ç®—æ³•"
tags: ["æœºå™¨å­¦ä¹ ", "NumPy", "å‘é‡åŒ–ç¼–ç¨‹", "KNN", "ç‰¹å¾å·¥ç¨‹", "AIE54"]
readingTime: 15
hasImages: true
slug: "2024-06-14-getting-started"
---

# æœºå™¨å­¦ä¹ 02 - AIE54 Day02å­¦ä¹ ç¬”è®°

> **å­¦ä¹ æ—¥æœŸ**ï¼š2024-06-14  
> **ä¸»è®²è€å¸ˆ**ï¼šææ™“å  
> **è¯¾æ—¶**ï¼š6  
> **æ–‡æ¡£æ¥æº**ï¼šAIE54_day02-æœºå™¨å­¦ä¹ 02.pdf

## è¯¾ç¨‹å…³é”®è¯
NumPy | å‘é‡åŒ–æ“ä½œ | å¹¿æ’­æœºåˆ¶ | ç‰¹å¾å·¥ç¨‹ | Kè¿‘é‚»ç®—æ³• | æ ‡å‡†åŒ–

---

## ğŸ”¢ ç¬¬ä¸€éƒ¨åˆ†ï¼šNumPy åŸºæœ¬æ“ä½œ

### 1.1 æ•°ç»„åˆ›å»º

**æ ¸å¿ƒæ¦‚å¿µ**ï¼šNumPy æ˜¯ Python ç§‘å­¦è®¡ç®—çš„åŸºç¡€åº“ï¼Œæä¾›é«˜æ•ˆçš„å¤šç»´æ•°ç»„å¯¹è±¡å’Œæ•°å­¦å‡½æ•°ã€‚

```python
import numpy as np

# ä»åˆ—è¡¨åˆ›å»ºæ•°ç»„
scores = [random.randint(0, 100) for _ in range(300)]
arr = np.array(scores)

# åˆ›å»ºç‰¹æ®Šæ•°ç»„
zeros_array = np.zeros(shape=(2, 3, 4, 5))  # å…¨é›¶æ•°ç»„
ones_array = np.ones(shape=(2,))            # å…¨ä¸€æ•°ç»„
range_array = np.arange(10)                 # 0-9çš„æ•°ç»„
linspace_array = np.linspace(-10, 10, 100) # ç­‰å·®æ•°åˆ—
```

**é‡è¦å±æ€§**ï¼š
- `arr.shape` : æ•°ç»„å½¢çŠ¶
- `arr.size` : å…ƒç´ æ€»æ•°
- `arr.dtype` : æ•°æ®ç±»å‹

### 1.2 å…ƒç´ çº§è¿ç®—ï¼ˆElement-wise Operationsï¼‰

**å…³é”®ç‰¹æ€§**ï¼šNumPy æ”¯æŒå‘é‡åŒ–æ“ä½œï¼Œè‡ªåŠ¨åº”ç”¨åˆ°æ¯ä¸ªå…ƒç´ ä¸Šã€‚

```python
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])

# åŸºæœ¬è¿ç®—
result_add = a + b    # [5, 7, 9]
result_mul = a * b    # [4, 10, 18]
result_pow = a ** b   # [1, 32, 729]

# ä¸æ ‡é‡è¿ç®—
scalar_add = a + 1    # [2, 3, 4]
```

**ä¸ Python åˆ—è¡¨å¯¹æ¯”**ï¼š
- åˆ—è¡¨ï¼š`[1,2,3] + [4,5,6] = [1,2,3,4,5,6]` (è¿æ¥)
- NumPyï¼š`array([1,2,3]) + array([4,5,6]) = array([5,7,9])` (å…ƒç´ çº§ç›¸åŠ )

### 1.3 å¹¿æ’­æœºåˆ¶ï¼ˆBroadcastingï¼‰

**å®šä¹‰**ï¼šåœ¨ä¸å¼•èµ·æ­§ä¹‰çš„å‰æä¸‹ï¼ŒNumPy è‡ªåŠ¨è°ƒæ•´æ•°ç»„å½¢çŠ¶ä»¥è¿›è¡Œè¿ç®—ã€‚

```python
arr1 = np.array([1, 2, 3, 4, 5])  # shape: (5,)
arr2 = np.array([3])              # shape: (1,)
result = arr1 + arr2              # å¹¿æ’­æˆåŠŸ: [4, 5, 6, 7, 8]

# äºŒç»´å¹¿æ’­ç¤ºä¾‹
arr2d = np.array([[1], [2]])      # shape: (2, 1)
result2d = arr1 + arr2d           # ç»“æœ shape: (2, 5)
```

**å¹¿æ’­è§„åˆ™**ï¼š
1. ä»æœ€åä¸€ä¸ªç»´åº¦å¼€å§‹æ¯”è¾ƒ
2. ç»´åº¦å¤§å°ç›¸ç­‰æˆ–å…¶ä¸­ä¸€ä¸ªä¸º 1 æ—¶å¯ä»¥å¹¿æ’­
3. ç¼ºå¤±ç»´åº¦è§†ä¸º 1

### 1.4 æ•°å­¦å‡½æ•°

```python
arr = np.array([1, 2, 3, 4, 5])

# ä¸‰è§’å‡½æ•°
sin_values = np.sin(arr)
cos_values = np.cos(arr)

# æŒ‡æ•°å’Œå¯¹æ•°
exp_values = np.exp(arr)
log_values = np.log(arr)
log2_values = np.log2(arr)
log10_values = np.log10(arr)
```

---

## ğŸ“ ç¬¬äºŒéƒ¨åˆ†ï¼šNumPy å‘é‡åŒ–æ“ä½œ

### 2.1 å‘é‡ç©ºé—´åŸºç¡€
**æ ¸å¿ƒæ¦‚å¿µ**ï¼šä»å‘é‡ç©ºé—´è§’åº¦ç†è§£æ•°æ®ï¼Œæ¶‰åŠæ¨¡é•¿ã€å¤¹è§’å’Œå†…ç§¯ã€‚

### 2.2 å‘é‡æ¨¡é•¿è®¡ç®—

**æ•°å­¦å…¬å¼**ï¼šå¯¹äºå‘é‡ v = [vâ‚, vâ‚‚, ..., vâ‚™]ï¼Œæ¨¡é•¿ä¸ºï¼š

|v| = âˆš(vâ‚Â² + vâ‚‚Â² + ... + vâ‚™Â²)

```python
v1 = np.array([1, 2, 3, 4, 5])

# æ–¹æ³•1ï¼šæ‰‹åŠ¨è®¡ç®—
norm_manual = (v1 ** 2).sum() ** 0.5

# æ–¹æ³•2ï¼šä½¿ç”¨ NumPy å‡½æ•°
norm_numpy = np.linalg.norm(v1)
```

### 2.3 å‘é‡å†…ç§¯ä¸ä½™å¼¦ç›¸ä¼¼åº¦

**å†…ç§¯å…¬å¼**ï¼švâ‚ Â· vâ‚‚ = Î£áµ¢â‚Œâ‚â¿ vâ‚áµ¢ Ã— vâ‚‚áµ¢

**ä½™å¼¦ç›¸ä¼¼åº¦å…¬å¼**ï¼šcos(Î¸) = (vâ‚ Â· vâ‚‚) / (|vâ‚| Ã— |vâ‚‚|)

```python
v1 = np.array([1, 2, 3, 4, 5])
v2 = np.array([6, 3, 1, 3, 6])

# å†…ç§¯è®¡ç®—
dot_product_manual = (v1 * v2).sum()
dot_product_operator = v1 @ v2

# ä½™å¼¦ç›¸ä¼¼åº¦
cosine_similarity = v1 @ v2 / (np.linalg.norm(v1) * np.linalg.norm(v2))
```

### 2.4 æ¬§å‡ é‡Œå¾—è·ç¦»

**å…¬å¼**ï¼šd(vâ‚, vâ‚‚) = âˆš(Î£áµ¢â‚Œâ‚â¿ (vâ‚áµ¢ - vâ‚‚áµ¢)Â²)

```python
# æ¬§å‡ é‡Œå¾—è·ç¦»
euclidean_distance = ((v1 - v2) ** 2).sum() ** 0.5
# æˆ–ä½¿ç”¨ NumPy
euclidean_distance = np.linalg.norm(v1 - v2)
```

### 2.5 çŸ©é˜µè¿ç®—

```python
m1 = np.arange(12).reshape(3, 4)  # 3Ã—4 çŸ©é˜µ
m2 = np.arange(12).reshape(4, 3)  # 4Ã—3 çŸ©é˜µ

# çŸ©é˜µä¹˜æ³•ï¼ˆæ³¨æ„ç»´åº¦åŒ¹é…ï¼‰
result = m1 @ m2  # ç»“æœä¸º 3Ã—3 çŸ©é˜µ
```

---

## ğŸ”§ ç¬¬ä¸‰éƒ¨åˆ†ï¼šç‰¹å¾å·¥ç¨‹

### 3.1 æ•°æ®é›†ä»‹ç»

**ä½¿ç”¨ä¹³è…ºç™Œå¨æ–¯åº·è¾›æ•°æ®é›†**ï¼š
- æ ·æœ¬æ•°é‡ï¼š569 ä¸ª
- ç‰¹å¾æ•°é‡ï¼š30 ä¸ªæ•°å€¼ç‰¹å¾
- ç›®æ ‡å˜é‡ï¼šäºŒåˆ†ç±»ï¼ˆæ¶æ€§/è‰¯æ€§ï¼‰

```python
from sklearn.datasets import load_breast_cancer

X, y = load_breast_cancer(return_X_y=True)
print(f"ç‰¹å¾çŸ©é˜µå½¢çŠ¶: {X.shape}")  # (569, 30)
print(f"ç›®æ ‡å‘é‡å½¢çŠ¶: {y.shape}")  # (569,)
```

### 3.2 ç‰¹å¾æ ‡å‡†åŒ–

**é—®é¢˜**ï¼šä¸åŒç‰¹å¾çš„é‡çº²å’Œæ•°å€¼èŒƒå›´å·®å¼‚å·¨å¤§ï¼Œä¼šå½±å“ç®—æ³•æ€§èƒ½ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šZ-score æ ‡å‡†åŒ–

**æ•°å­¦å…¬å¼**ï¼šx_æ ‡å‡†åŒ– = (x - Î¼) / Ïƒ

å…¶ä¸­ï¼š
- Î¼ æ˜¯ç‰¹å¾å‡å€¼
- Ïƒ æ˜¯ç‰¹å¾æ ‡å‡†å·®

```python
# è®¡ç®—ç»Ÿè®¡é‡
mu = X.mean(axis=0)      # å„ç‰¹å¾å‡å€¼
sigma = X.std(axis=0)    # å„ç‰¹å¾æ ‡å‡†å·®

# æ ‡å‡†åŒ–
X_standardized = (X - mu) / sigma
```

**æ ‡å‡†åŒ–æ•ˆæœ**ï¼š
- å‡å€¼å˜ä¸º 0
- æ ‡å‡†å·®å˜ä¸º 1
- æ¶ˆé™¤é‡çº²å½±å“

### 3.3 å…¶ä»–è§„èŒƒåŒ–æ–¹æ³•

**Min-Max è§„èŒƒåŒ–**ï¼š

```python
# Min-Max è§„èŒƒåŒ–åˆ° [0,1] åŒºé—´
X_minmax = (X - X.min(axis=0)) / (X.max(axis=0) - X.min(axis=0))
```

---

## ğŸ¯ ç¬¬å››éƒ¨åˆ†ï¼šK è¿‘é‚»åˆ†ç±»ç®—æ³•

### 4.1 ç®—æ³•åŸç†

**KNN æ ¸å¿ƒæ€æƒ³**ï¼šæ ¹æ®æ ·æœ¬åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„ K ä¸ªæœ€è¿‘é‚»å±…çš„æ ‡ç­¾æ¥é¢„æµ‹å…¶ç±»åˆ«ã€‚

**å†³ç­–è§„åˆ™**ï¼šå¯¹äºåˆ†ç±»é—®é¢˜ï¼Œé‡‡ç”¨å¤šæ•°æŠ•ç¥¨åŸåˆ™ã€‚

### 4.2 å®Œæ•´æœºå™¨å­¦ä¹ æµç¨‹

```python
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier

# 1. åŠ è½½æ•°æ®
X, y = load_breast_cancer(return_X_y=True)

# 2. æ•°æ®åˆ‡åˆ†
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, shuffle=True, random_state=0
)

# 3. ç‰¹å¾æ ‡å‡†åŒ–ï¼ˆé‡è¦ï¼ï¼‰
mu = X_train.mean(axis=0)
sigma = X_train.std(axis=0)
X_train_scaled = (X_train - mu) / sigma
X_test_scaled = (X_test - mu) / sigma

# 4. æ¨¡å‹è®­ç»ƒ
knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train_scaled, y_train)

# 5. é¢„æµ‹å’Œè¯„ä¼°
y_pred = knn.predict(X_test_scaled)
accuracy = (y_pred == y_test).mean()
print(f"å‡†ç¡®ç‡: {accuracy:.4f}")
```

### 4.3 å…³é”®æ³¨æ„äº‹é¡¹

**ä¸ºä»€ä¹ˆéœ€è¦æ ‡å‡†åŒ–ï¼Ÿ**
- KNN åŸºäºè·ç¦»è®¡ç®—
- ä¸åŒç‰¹å¾çš„æ•°å€¼èŒƒå›´å·®å¼‚ä¼šå¯¼è‡´æŸäº›ç‰¹å¾ä¸»å¯¼è·ç¦»è®¡ç®—
- æ ‡å‡†åŒ–ç¡®ä¿æ‰€æœ‰ç‰¹å¾ç­‰æƒé‡å‚ä¸è®¡ç®—

**æ•°æ®æ³„éœ²é˜²èŒƒ**ï¼š
- âœ… **æ­£ç¡®åšæ³•**ï¼šç”¨è®­ç»ƒé›†ç»Ÿè®¡é‡æ ‡å‡†åŒ–æµ‹è¯•é›†
- âŒ **é”™è¯¯åšæ³•**ï¼šç”¨å…¨ä½“æ•°æ®ç»Ÿè®¡é‡æ ‡å‡†åŒ–

---

## ğŸ“ˆ ç¬¬äº”éƒ¨åˆ†ï¼šK è¿‘é‚»å›å½’ç®—æ³•

### 5.1 æ•°æ®é›†ä»‹ç»

**ä½¿ç”¨æ³¢å£«é¡¿æˆ¿ä»·æ•°æ®é›†**ï¼š
- æ ·æœ¬æ•°é‡ï¼š506 ä¸ª
- ç‰¹å¾æ•°é‡ï¼š13 ä¸ªæˆ¿å±‹ç›¸å…³ç‰¹å¾
- ç›®æ ‡å˜é‡ï¼šæˆ¿ä»·ï¼ˆè¿ç»­å€¼ï¼‰

```python
import pandas as pd

# åŠ è½½æ•°æ®
data = pd.read_csv("boston_house_prices.csv", skiprows=1)
X = data.loc[:, :"LSTAT"].to_numpy()  # ç‰¹å¾
y = data.loc[:, "MEDV"].to_numpy()    # ç›®æ ‡å˜é‡ï¼ˆæˆ¿ä»·ï¼‰
```

### 5.2 å›å½’ç®—æ³•æµç¨‹

```python
from sklearn.neighbors import KNeighborsRegressor

# æ•°æ®åˆ‡åˆ†å’Œæ ‡å‡†åŒ–ï¼ˆä¸åˆ†ç±»ç›¸åŒï¼‰
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=0
)

mu = X_train.mean(axis=0)
sigma = X_train.std(axis=0)
X_train_scaled = (X_train - mu) / sigma
X_test_scaled = (X_test - mu) / sigma

# å›å½’æ¨¡å‹
knn_reg = KNeighborsRegressor(n_neighbors=5)
knn_reg.fit(X_train_scaled, y_train)
y_pred = knn_reg.predict(X_test_scaled)
```

### 5.3 å›å½’è¯„ä¼°æŒ‡æ ‡

**å¹³å‡ç»å¯¹è¯¯å·® (MAE)**ï¼šMAE = (1/n) Ã— Î£áµ¢â‚Œâ‚â¿ |yáµ¢ - Å·áµ¢|

**å‡æ–¹è¯¯å·® (MSE)**ï¼šMSE = (1/n) Ã— Î£áµ¢â‚Œâ‚â¿ (yáµ¢ - Å·áµ¢)Â²

```python
# è¯„ä¼°æŒ‡æ ‡è®¡ç®—
mae = abs(y_pred - y_test).mean()
mse = ((y_pred - y_test) ** 2).mean()
rmse = mse ** 0.5

print(f"å¹³å‡ç»å¯¹è¯¯å·®: {mae:.4f}")
print(f"å‡æ–¹è¯¯å·®: {mse:.4f}")
print(f"å‡æ–¹æ ¹è¯¯å·®: {rmse:.4f}")
```

---

## ğŸ”‘ æ ¸å¿ƒè¦ç‚¹æ€»ç»“

### NumPy æ ¸å¿ƒæ¦‚å¿µ
- **å‘é‡åŒ–æ“ä½œ**ï¼šæé«˜è®¡ç®—æ•ˆç‡çš„å…³é”®
- **å¹¿æ’­æœºåˆ¶**ï¼šå®ç°ä¸åŒå½¢çŠ¶æ•°ç»„çš„è¿ç®—
- **çº¿æ€§ä»£æ•°å‡½æ•°**ï¼šæ¨¡é•¿ã€å†…ç§¯ã€è·ç¦»è®¡ç®—

### ç‰¹å¾å·¥ç¨‹è¦ç‚¹
- **æ ‡å‡†åŒ–å¿…è¦æ€§**ï¼šæ¶ˆé™¤ç‰¹å¾é—´çš„é‡çº²å·®å¼‚
- **æ•°æ®æ³„éœ²é˜²èŒƒ**ï¼šå§‹ç»ˆç”¨è®­ç»ƒé›†ç»Ÿè®¡é‡å¤„ç†æµ‹è¯•é›†
- **Z-score vs Min-Max**ï¼šæ ¹æ®æ•°æ®åˆ†å¸ƒé€‰æ‹©åˆé€‚æ–¹æ³•

### KNN ç®—æ³•æ ¸å¿ƒ
- **è·ç¦»åº¦é‡**ï¼šæ¬§å‡ é‡Œå¾—è·ç¦»æœ€å¸¸ç”¨
- **K å€¼é€‰æ‹©**ï¼šå½±å“æ¨¡å‹å¤æ‚åº¦å’Œæ€§èƒ½
- **åˆ†ç±» vs å›å½’**ï¼šæŠ•ç¥¨æœºåˆ¶ vs å¹³å‡å€¼æœºåˆ¶

### æœºå™¨å­¦ä¹ æ ‡å‡†æµç¨‹
1. **æ•°æ®åŠ è½½** â†’ 2. **æ•°æ®åˆ‡åˆ†** â†’ 3. **ç‰¹å¾é¢„å¤„ç†** â†’ 4. **æ¨¡å‹è®­ç»ƒ** â†’ 5. **é¢„æµ‹è¯„ä¼°**

---

## ğŸš€ å®è·µå»ºè®®

1. **ä»£ç å®è·µ**ï¼šæ¯ä¸ªæ¦‚å¿µéƒ½è¦äº²è‡ªç¼–å†™ä»£ç éªŒè¯
2. **å‚æ•°è°ƒä¼˜**ï¼šå°è¯•ä¸åŒçš„ K å€¼ï¼Œè§‚å¯Ÿæ€§èƒ½å˜åŒ–
3. **æ•°æ®å¯è§†åŒ–**ï¼šç”¨å›¾è¡¨ç†è§£æ•°æ®åˆ†å¸ƒå’Œç®—æ³•æ•ˆæœ
4. **æ‰©å±•å­¦ä¹ **ï¼šäº†è§£å…¶ä»–è·ç¦»åº¦é‡æ–¹æ³•å’Œé¢„å¤„ç†æŠ€æœ¯

---

## å­¦ä¹ å¿ƒå¾—

è¿™èŠ‚è¯¾ç³»ç»Ÿåœ°å­¦ä¹ äº†æœºå™¨å­¦ä¹ çš„åŸºç¡€å·¥å…·å’Œç®—æ³•ï¼š

1. **NumPyçš„é‡è¦æ€§**ï¼šä½œä¸ºç§‘å­¦è®¡ç®—åŸºç¡€ï¼Œå‘é‡åŒ–æ“ä½œå¤§å¤§æå‡äº†è®¡ç®—æ•ˆç‡
2. **ç‰¹å¾å·¥ç¨‹çš„å…³é”®æ€§**ï¼šæ•°æ®é¢„å¤„ç†ç›´æ¥å½±å“æ¨¡å‹æ€§èƒ½ï¼Œæ ‡å‡†åŒ–æ˜¯å¿…ä¸å¯å°‘çš„æ­¥éª¤
3. **KNNç®—æ³•çš„ç®€æ´æ€§**ï¼šè™½ç„¶ç®€å•ï¼Œä½†åœ¨å¾ˆå¤šåœºæ™¯ä¸‹éƒ½å¾ˆæœ‰æ•ˆ
4. **æœºå™¨å­¦ä¹ æµç¨‹çš„è§„èŒƒæ€§**ï¼šä¸¥æ ¼æŒ‰ç…§æ ‡å‡†æµç¨‹å¯ä»¥é¿å…å¾ˆå¤šå¸¸è§é”™è¯¯

## ä¸‹ä¸€æ­¥å­¦ä¹ è®¡åˆ’
- 06-17

